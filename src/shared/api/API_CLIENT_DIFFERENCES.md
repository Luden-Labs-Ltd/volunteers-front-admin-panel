# Различия между API клиентами

## Обзор

В проекте используются два API клиента:
- `volunteers-front/src/shared/api/base-client.ts` - для основного фронтенда
- `volunteers-front-admin-panel/src/shared/api/base-client.ts` - для админ-панели

## Различия

### 1. Endpoint для refresh токенов

**Основной фронтенд:**
- Использует `/auth/user/refresh` для обновления токенов

**Админ-панель:**
- Использует `/auth/admin/refresh` для обновления токенов

**Причина:** Разные роли пользователей требуют разных endpoints для авторизации.

### 2. Обработка ошибок

**Основной фронтенд:**
- Использует `ApiException.fromResponse()` для создания типизированных ошибок
- Более детальная обработка ошибок с типами

**Админ-панель:**
- Использует простой `Error` с дополнительными полями `status` и `response`
- Более простая обработка ошибок

**Причина:** Разные требования к обработке ошибок в разных частях приложения.

### 3. Определение API URL

**Основной фронтенд:**
- Автоматическое определение API URL на основе hostname
- Поддержка локальной сети (192.168.x.x, 10.x.x.x, 172.x.x.x)
- Логирование API URL в development режиме

**Админ-панель:**
- Простое использование переменной окружения или production URL
- Нет автоматического определения

**Причина:** Разные требования к конфигурации для разных окружений.

### 4. Обработка пустых ответов

**Основной фронтенд:**
- Простая обработка - возвращает `response.json()`
- Предполагает, что ответ всегда JSON

**Админ-панель:**
- Детальная обработка пустых ответов (204, content-length: 0)
- Проверка наличия контента перед парсингом JSON
- Обработка случаев, когда ответ не является JSON

**Причина:** Админ-панель работает с большим количеством DELETE запросов, которые могут возвращать пустые ответы.

## Рекомендации

1. **Не унифицировать** - различия обоснованы разными требованиями
2. **Документировать** - все различия должны быть задокументированы (этот файл)
3. **Синхронизировать логику** - где возможно, использовать общие паттерны

## Общие паттерны

Оба клиента используют:
- Автоматическое обновление токенов при 401 ошибке
- Одинаковую логику refresh токенов
- Одинаковую структуру headers
- Одинаковую обработку Authorization header
